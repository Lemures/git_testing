and here are some more code changes
